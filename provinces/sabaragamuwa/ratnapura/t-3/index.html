<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sri Lanka Buddhist Temples</title>

<!-- ‚úÖ Correct CSS path for temple pages inside t-x folders -->
<link rel="stylesheet" href="../../../style.css">

</head>

<body>

<!-- Headings -->
<div class="title-box1"><h1 id="title-si"></h1></div>
<div class="title-box2"><h1 id="title-en"></h1></div>

<!-- Main image -->
<img src="main.jpg" class="main-image" alt="Buddhist Temple">

<!-- Navigation buttons -->
<div class="nav-buttons">
    <button class="nav-btn" id="prevBtn">‚óÄ Previous</button>
    <button class="nav-btn" id="nextBtn">Next ‚ñ∂</button>
</div>

<!-- Action buttons -->
<div class="button-box">
    <button class="action-btn" onclick="window.open('https://www.google.com/maps/search/' + temple)">‡∑É‡∑í‡∂≠‡∑í‡∂∫‡∂∏/Maps</button>
    <button class="action-btn" onclick="window.open('https://www.google.com/search?tbm=isch&q=' + temple)">‡∂°‡∑è‡∂∫‡∑è‡∂ª‡∑ñ‡∂¥/Photos</button>
    <button class="action-btn" onclick="window.open('https://www.youtube.com/results?search_query=' + temple)">‡∑Ä‡∑ì‡∂©‡∑í‡∂∫‡∑ù/Videos</button>
</div>
<div class="button-box">
<button class="action-btn" onclick="window.location.href='../../../../index.html'">üè† First Page</button>


</div>
<!-- Footer -->
<footer>
    <div class="footer-content">
        ¬© Project By: Sunil Ranasinghe<br>
        ‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è‡∑Ä‡∑ö ‡∑É‡∂Ç‡∑É‡∑ä‡∂ö‡∑ò‡∂≠‡∑í‡∂ö ‡∑Ñ‡∑è ‡∂Ü‡∂ú‡∂∏‡∑í‡∂ö ‡∂ã‡∂ª‡∑î‡∂∏‡∂∫ ‡∑É‡∑î‡∂ª‡∑ê‡∂ö‡∑ì‡∂∏‡∂ß<br>
        Concept: Sampath Ranasinghe<br>
        Data: Danesh Ranasinghe
    </div>
</footer>

<!-- Headings and temple variable -->
<script>
fetch("info.txt")
.then(res => res.text())
.then(data => {
    const lines = data.split("\n");
    const info = {};
    lines.forEach(line => {
        const parts = line.split("=");
        if(parts.length === 2) info[parts[0].trim()] = parts[1].trim();
    });
    document.getElementById("title-si").textContent = info.si || "";
    document.getElementById("title-en").textContent = info.en || "";
    window.temple = info.var || "";
});
</script>

<!-- Navigation script -->
<script>
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");

let currentTempleId = "";
let templeList = [];

/* 1Ô∏è‚É£ Read current temple ID */
fetch("info.txt")
  .then(res => res.text())
  .then(data => {
    data.split("\n").forEach(line => {
      const parts = line.split("=");
      if (parts[0].trim() === "id") {
        currentTempleId = parts[1].trim();
      }
    });
    loadTemples();
  })
  .catch(err => console.error("Error reading info.txt:", err));

/* 2Ô∏è‚É£ Read temples.txt safely */
function loadTemples() {
  fetch("../temples.txt")
    .then(res => res.text())
    .then(data => {
      templeList = data
        .split("\n")
        .map(line => line.trim())
        .filter(line => line !== "" && line.includes("|"))
        .map(line => line.split("|")[0].trim());

      setupNavigation();
    })
    .catch(err => console.error("Error reading temples.txt:", err));
}

/* 3Ô∏è‚É£ Navigation logic */
function setupNavigation() {
  const currentIndex = templeList.indexOf(currentTempleId);

  if (currentIndex === -1) {
    console.error("Temple ID not found:", currentTempleId);
    prevBtn.style.display = "none";
    nextBtn.style.display = "none";
    return;
  }

  /* Previous button */
  if (currentIndex > 0) {
    prevBtn.style.display = "inline-block";
    prevBtn.onclick = () => {
      window.location.href = "../" + templeList[currentIndex - 1] + "/index.html";
    };
  } else {
    prevBtn.style.display = "none";
  }

  /* Next button */
  if (currentIndex < templeList.length - 1) {
    nextBtn.style.display = "inline-block";
    nextBtn.onclick = () => {
      window.location.href = "../" + templeList[currentIndex + 1] + "/index.html";
    };
  } else {
    nextBtn.style.display = "none";
  }
}
</script>

<!-- Swipe navigation for mobile -->
<script>
let touchStartX = 0;
let touchEndX = 0;

document.addEventListener("touchstart", e => touchStartX = e.changedTouches[0].screenX);
document.addEventListener("touchend", e => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
});

function handleSwipe() {
    const swipeDistance = touchEndX - touchStartX;
    if (Math.abs(swipeDistance) < 50) return; // ignore small swipe

    if (swipeDistance > 0 && prevBtn.style.display !== "none") prevBtn.click();
    if (swipeDistance < 0 && nextBtn.style.display !== "none") nextBtn.click();
}
</script>

</body>
</html>
